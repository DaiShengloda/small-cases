<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title>动态生成表格</title>
  <style>
      div#box{margin:20px;font-weight:bold;}
      div#box input{width:60px;height:30;border:solid #838383 2px;}
      div#box button{font-weight:bold;font-size:0.9em;width:90px;height:30px;background-color:#585858;color:white;border:none;border-radius:5px;}
      div#box span{font-weight:normal;font-size:0.7em;margin-left:20px;color:#424242;}
      table{border-spacing:3px;}
      table td{width:30px;height:30px;text-align:center;background-color:#45AB12;color:white;}
  </style>
  </head>
  <body>
      <div id="box">
          <label>行数</label>
          <input type="text" value="">
          <label>列数</label>
          <input type="text" value="">
          <button>生成表格</button><span>行、列的值在1-50之间</span>
      </div>
      <table frame="box">         
      </table>
  <script type="text/javascript">
  (function (){
    var div=document.getElementById("box"),
        input=div.getElementsByTagName("input"),
        rows,cols,i,j,
        tBody,color,
        button=div.getElementsByTagName("button")[0],
        table=document.getElementsByTagName("table")[0];
    input[0].onkeyup=function (){
        rows=this.value;
        if (rows>50||rows<=0){
            alert("请输入1-50之间的数字");
            this.value="";
        }
    }
    input[1].onkeyup=function (){
        cols=this.value;
        if (cols>50||cols<=0){
            alert("请输入1-50之间的数字");
            this.value="";
        }
    }

//随机生成一种颜色
function createColor(){
    color="";
    var num=(Math.floor(Math.random()*254+1)).toString(16),
        num2=(Math.floor(Math.random()*254+1)).toString(16),
        num3=(Math.floor(Math.random()*254+1)).toString(16);
    color="#"+num+num2+num3;
    return color;    
}

//生成列
function createCol(){ 
    tBody="";
    for (j=0;j<cols;j++){
         //随机生成1-15的数字
         var num=Math.floor(Math.random()*15+1);
         var backColor=createColor();
         var style="style"+"="+"'"+"background"+"-"+"color"+":"+backColor+"'";
         tBody+="<td "+style+">"+num+"</td>";
    }
    return tBody;
  }   
    
    button.onclick=function (){
        //生成行
        table.innerHTML="";       
        for(i=0;i<rows;i++){
            var string=createCol(); 
            table.innerHTML+="<tr>"+string+"</tr>";
        }
        
    }
   
})();
  </script>
  </body>
</html>
